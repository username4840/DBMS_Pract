# mongo_connect.py     *** 8th practical.***
from pymongo import MongoClient

# Step 1: Connect to MongoDB
client = MongoClient("mongodb://localhost:27017/")
print("âœ… Connection Successful")

# Step 2: Create / Access database
db = client["library_db"]

# Step 3: Create / Access collection
collection = db["books"]

# Step 4: Insert documents (Add)
book1 = {"book_id": 1, "book_name": "DBMS Concepts", "author": "Korth"}
book2 = {"book_id": 2, "book_name": "Let Us C", "author": "Yashwant Kanetkar"}
collection.insert_many([book1, book2])
print("âœ… Records Inserted Successfully")

# Step 5: Display all records
print("\nğŸ“š All Books in Database:")
for book in collection.find():
    print(book)

# Step 6: Update record
collection.update_one({"book_id": 1}, {"$set": {"author": "Silberschatz"}})
print("\nâœï¸ Record Updated Successfully")

# Step 7: Delete record
collection.delete_one({"book_id": 2})
print("\nğŸ—‘ï¸ Record Deleted Successfully")

# Step 8: Final display
print("\nğŸ“˜ Final Books Collection:")
for book in collection.find():
    print(book)

client.close()
print("\nğŸ”’ Connection Closed")
